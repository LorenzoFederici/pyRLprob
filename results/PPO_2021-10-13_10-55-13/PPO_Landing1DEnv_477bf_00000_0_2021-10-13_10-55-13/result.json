{"episode_reward_max": -8.853504046844465, "episode_reward_min": -13.565842787602612, "episode_reward_mean": -11.357343858028138, "episode_len_mean": 11.6875, "episode_media": {}, "episodes_this_iter": 16, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 1.1082469827945869, "cstr_viol_min": 0.8467172951681436, "cstr_viol_max": 1.3384859109932252}, "hist_stats": {"episode_reward": [-11.323882275834798, -8.853504046844465, -12.533355623214977, -13.565842787602612, -11.179632350503603, -13.043990403493245, -11.331709133107468, -10.073984906339719, -12.704161765258256, -12.850951224644978, -13.23098847277959, -9.964552791368817, -9.617687690257323, -8.89745166708712, -11.047989973612358, -11.497816616500886], "episode_lengths": [11, 13, 12, 11, 11, 12, 11, 12, 11, 12, 11, 12, 13, 12, 11, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.06363785680704662, "mean_inference_ms": 0.8024088746356003, "mean_action_processing_ms": 0.05763980068792021, "mean_env_wait_ms": 0.3244312452976274, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 187, "agent_timesteps_total": 187, "timers": {"sample_time_ms": 128.869, "sample_throughput": 1451.083, "load_time_ms": 0.016, "load_throughput": 11367171.71, "learn_time_ms": 335.718, "learn_throughput": 557.015, "update_time_ms": 0.989}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.0005000000237487257, "total_loss": 30.224273681640625, "policy_loss": -0.02690284699201584, "vf_loss": 60.50235366821289, "vf_explained_var": -0.025257473811507225, "kl": 0.011840355582535267, "entropy": 1.4138845205307007, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}}}, "num_steps_sampled": 187, "num_agent_steps_sampled": 187, "num_steps_trained": 187, "num_agent_steps_trained": 187}, "evaluation": {"episode_reward_max": -10.041801572380622, "episode_reward_min": -10.041801572380622, "episode_reward_mean": -10.041801572380622, "episode_len_mean": 12.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 0.9715128341986896, "cstr_viol_min": 0.9715128341986896, "cstr_viol_max": 0.9715128341986896}, "hist_stats": {"episode_reward": [-10.041801572380622, -10.041801572380622], "episode_lengths": [12, 12]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.09348869323730469, "mean_inference_ms": 1.5698432922363281, "mean_action_processing_ms": 0.055294036865234375, "mean_env_wait_ms": 0.3218364715576172, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 16, "training_iteration": 1, "experiment_id": "56d08bf2f0454f518cb9b9f9cac64b85", "date": "2021-10-13_10-55-19", "timestamp": 1634115319, "time_this_iter_s": 0.574028730392456, "time_total_s": 0.574028730392456, "pid": 519563, "hostname": "spectral02-sys", "node_ip": "10.60.110.169", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 15, "batch_mode": "complete_episodes", "gamma": 1.0, "lr": 0.0005, "train_batch_size": 150, "model": {"_use_default_native_models": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": true, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Landing1DEnv", "observation_space": null, "action_space": null, "env_config": {"H": 15, "Tmax": 1.227, "c": 2.349, "g": 1.0, "h0": 1.0, "hf": 0.0, "m0": 1.0, "tf": 1.397, "v0": -0.783, "vf": 0.0}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "INFO", "callbacks": "<class 'pyrlprob.utils.callbacks.TrainingCallbacks'>", "ignore_worker_failures": true, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_num_episodes": 1, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"env_config": {"prng_seed": 0}, "explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.0, "sgd_minibatch_size": 15, "shuffle_sequences": true, "num_sgd_iter": 20, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 0.574028730392456, "timesteps_since_restore": 0, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 23.6, "ram_util_percent": 21.9}, "trial_id": "477bf_00000"}
{"episode_reward_max": -2.983645409721909, "episode_reward_min": -13.565842787602612, "episode_reward_mean": -10.13661979905175, "episode_len_mean": 12.35483870967742, "episode_media": {}, "episodes_this_iter": 15, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 0.9809145172566084, "cstr_viol_min": 0.24219018914290052, "cstr_viol_max": 1.3384859109932252}, "hist_stats": {"episode_reward": [-11.323882275834798, -8.853504046844465, -12.533355623214977, -13.565842787602612, -11.179632350503603, -13.043990403493245, -11.331709133107468, -10.073984906339719, -12.704161765258256, -12.850951224644978, -13.23098847277959, -9.964552791368817, -9.617687690257323, -8.89745166708712, -11.047989973612358, -11.497816616500886, -2.983645409721909, -8.025866553772515, -6.4023363744531245, -7.967184973025262, -8.98433458556934, -11.91778323702005, -9.595119923432668, -10.576597664041843, -10.688640979897295, -9.541940511110871, -8.950985258906616, -8.40723290514496, -8.950554180213878, -11.146002331083709, -8.379487154760048], "episode_lengths": [11, 13, 12, 11, 11, 12, 11, 12, 11, 12, 11, 12, 13, 12, 11, 12, 15, 14, 13, 14, 12, 12, 13, 12, 12, 13, 14, 14, 13, 11, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.061493467468881624, "mean_inference_ms": 0.7286395817491719, "mean_action_processing_ms": 0.05716487331848396, "mean_env_wait_ms": 0.32533478125553333, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 383, "agent_timesteps_total": 383, "timers": {"sample_time_ms": 116.721, "sample_throughput": 1640.668, "load_time_ms": 0.017, "load_throughput": 11233695.329, "learn_time_ms": 274.934, "learn_throughput": 696.53, "update_time_ms": 1.107}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.0005000000237487257, "total_loss": 2.484344244003296, "policy_loss": -0.020093025639653206, "vf_loss": 5.008874416351318, "vf_explained_var": 0.02306196466088295, "kl": 0.01397552341222763, "entropy": 1.4186450242996216, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}}}, "num_steps_sampled": 383, "num_agent_steps_sampled": 383, "num_steps_trained": 383, "num_agent_steps_trained": 383}, "evaluation": {"episode_reward_max": -7.973459136887959, "episode_reward_min": -7.973459136887959, "episode_reward_mean": -7.973459136887959, "episode_len_mean": 13.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 0.7563980280616454, "cstr_viol_min": 0.7563980280616454, "cstr_viol_max": 0.7563980280616454}, "hist_stats": {"episode_reward": [-7.973459136887959, -7.973459136887959], "episode_lengths": [13, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.07864540698481541, "mean_inference_ms": 1.0763710620356541, "mean_action_processing_ms": 0.061633540134803926, "mean_env_wait_ms": 0.3601149016735601, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 31, "training_iteration": 2, "experiment_id": "56d08bf2f0454f518cb9b9f9cac64b85", "date": "2021-10-13_10-55-19", "timestamp": 1634115319, "time_this_iter_s": 0.36102747917175293, "time_total_s": 0.935056209564209, "pid": 519563, "hostname": "spectral02-sys", "node_ip": "10.60.110.169", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 15, "batch_mode": "complete_episodes", "gamma": 1.0, "lr": 0.0005, "train_batch_size": 150, "model": {"_use_default_native_models": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": true, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Landing1DEnv", "observation_space": null, "action_space": null, "env_config": {"H": 15, "Tmax": 1.227, "c": 2.349, "g": 1.0, "h0": 1.0, "hf": 0.0, "m0": 1.0, "tf": 1.397, "v0": -0.783, "vf": 0.0}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "INFO", "callbacks": "<class 'pyrlprob.utils.callbacks.TrainingCallbacks'>", "ignore_worker_failures": true, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_num_episodes": 1, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"env_config": {"prng_seed": 0}, "explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.0, "sgd_minibatch_size": 15, "shuffle_sequences": true, "num_sgd_iter": 20, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 0.935056209564209, "timesteps_since_restore": 0, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.1, "ram_util_percent": 21.9}, "trial_id": "477bf_00000"}
{"episode_reward_max": -2.9774061294169827, "episode_reward_min": -13.565842787602612, "episode_reward_mean": -9.700331396023856, "episode_len_mean": 12.534883720930232, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 0.935553564728726, "cstr_viol_min": 0.239568631333228, "cstr_viol_max": 1.3384859109932252}, "hist_stats": {"episode_reward": [-11.323882275834798, -8.853504046844465, -12.533355623214977, -13.565842787602612, -11.179632350503603, -13.043990403493245, -11.331709133107468, -10.073984906339719, -12.704161765258256, -12.850951224644978, -13.23098847277959, -9.964552791368817, -9.617687690257323, -8.89745166708712, -11.047989973612358, -11.497816616500886, -2.983645409721909, -8.025866553772515, -6.4023363744531245, -7.967184973025262, -8.98433458556934, -11.91778323702005, -9.595119923432668, -10.576597664041843, -10.688640979897295, -9.541940511110871, -8.950985258906616, -8.40723290514496, -8.950554180213878, -11.146002331083709, -8.379487154760048, -6.713293220248094, -6.610941791306567, -11.075791882495283, -8.928348392327626, -8.591657254611894, -9.023310485944288, -11.692181753651928, -9.06170112698082, -10.230597973118822, -2.9774061294169827, -10.058152567443873, -7.915653680875344], "episode_lengths": [11, 13, 12, 11, 11, 12, 11, 12, 11, 12, 11, 12, 13, 12, 11, 12, 15, 14, 13, 14, 12, 12, 13, 12, 12, 13, 14, 14, 13, 11, 14, 14, 15, 13, 13, 12, 12, 12, 13, 12, 15, 11, 14]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.061101305540404535, "mean_inference_ms": 0.6983444649358002, "mean_action_processing_ms": 0.057229008297836365, "mean_env_wait_ms": 0.32640051939937054, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 539, "agent_timesteps_total": 539, "timers": {"sample_time_ms": 106.334, "sample_throughput": 1689.637, "load_time_ms": 0.017, "load_throughput": 10515022.586, "learn_time_ms": 233.021, "learn_throughput": 771.031, "update_time_ms": 1.065}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.0005000000237487257, "total_loss": 2.758134365081787, "policy_loss": -0.007861380465328693, "vf_loss": 5.531991481781006, "vf_explained_var": 0.06453292816877365, "kl": 0.010481446981430054, "entropy": 1.416323184967041, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}}}, "num_steps_sampled": 539, "num_agent_steps_sampled": 539, "num_steps_trained": 539, "num_agent_steps_trained": 539}, "evaluation": {"episode_reward_max": -5.1522075946939125, "episode_reward_min": -5.1522075946939125, "episode_reward_mean": -5.1522075946939125, "episode_len_mean": 15.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 0.46337358833782016, "cstr_viol_min": 0.46337358833782016, "cstr_viol_max": 0.46337358833782016}, "hist_stats": {"episode_reward": [-5.1522075946939125], "episode_lengths": [15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.07308974410548355, "mean_inference_ms": 0.9536562543926818, "mean_action_processing_ms": 0.061981605760978935, "mean_env_wait_ms": 0.3547162720651338, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 43, "training_iteration": 3, "experiment_id": "56d08bf2f0454f518cb9b9f9cac64b85", "date": "2021-10-13_10-55-20", "timestamp": 1634115320, "time_this_iter_s": 0.26003432273864746, "time_total_s": 1.1950905323028564, "pid": 519563, "hostname": "spectral02-sys", "node_ip": "10.60.110.169", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 15, "batch_mode": "complete_episodes", "gamma": 1.0, "lr": 0.0005, "train_batch_size": 150, "model": {"_use_default_native_models": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": true, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Landing1DEnv", "observation_space": null, "action_space": null, "env_config": {"H": 15, "Tmax": 1.227, "c": 2.349, "g": 1.0, "h0": 1.0, "hf": 0.0, "m0": 1.0, "tf": 1.397, "v0": -0.783, "vf": 0.0}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "INFO", "callbacks": "<class 'pyrlprob.utils.callbacks.TrainingCallbacks'>", "ignore_worker_failures": true, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_num_episodes": 1, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"env_config": {"prng_seed": 0}, "explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.0, "sgd_minibatch_size": 15, "shuffle_sequences": true, "num_sgd_iter": 20, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1.1950905323028564, "timesteps_since_restore": 0, "iterations_since_restore": 3, "perf": {}, "trial_id": "477bf_00000"}
{"episode_reward_max": -1.940999490083726, "episode_reward_min": -13.565842787602612, "episode_reward_mean": -9.220200457232066, "episode_len_mean": 12.771929824561404, "episode_media": {}, "episodes_this_iter": 14, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 0.8856874988005321, "cstr_viol_min": 0.1349308190939299, "cstr_viol_max": 1.3384859109932252}, "hist_stats": {"episode_reward": [-11.323882275834798, -8.853504046844465, -12.533355623214977, -13.565842787602612, -11.179632350503603, -13.043990403493245, -11.331709133107468, -10.073984906339719, -12.704161765258256, -12.850951224644978, -13.23098847277959, -9.964552791368817, -9.617687690257323, -8.89745166708712, -11.047989973612358, -11.497816616500886, -2.983645409721909, -8.025866553772515, -6.4023363744531245, -7.967184973025262, -8.98433458556934, -11.91778323702005, -9.595119923432668, -10.576597664041843, -10.688640979897295, -9.541940511110871, -8.950985258906616, -8.40723290514496, -8.950554180213878, -11.146002331083709, -8.379487154760048, -6.713293220248094, -6.610941791306567, -11.075791882495283, -8.928348392327626, -8.591657254611894, -9.023310485944288, -11.692181753651928, -9.06170112698082, -10.230597973118822, -2.9774061294169827, -10.058152567443873, -7.915653680875344, -9.63754549630483, -1.940999490083726, -9.331852721787463, -5.426051890637698, -3.548028893750522, -11.969284816459949, -9.972416605653176, -6.737318001128376, -6.2895839463147265, -8.407947192728763, -9.0303384873233, -5.406509584472341, -10.992621988137563, -9.746676918419546], "episode_lengths": [11, 13, 12, 11, 11, 12, 11, 12, 11, 12, 11, 12, 13, 12, 11, 12, 15, 14, 13, 14, 12, 12, 13, 12, 12, 13, 14, 14, 13, 11, 14, 14, 15, 13, 13, 12, 12, 12, 13, 12, 15, 11, 14, 14, 15, 13, 14, 15, 12, 12, 14, 14, 13, 13, 15, 12, 13]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.06077277142538203, "mean_inference_ms": 0.6753061717634686, "mean_action_processing_ms": 0.05754346392323702, "mean_env_wait_ms": 0.32833094811377167, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 728, "agent_timesteps_total": 728, "timers": {"sample_time_ms": 106.09, "sample_throughput": 1715.524, "load_time_ms": 0.017, "load_throughput": 10676410.182, "learn_time_ms": 217.813, "learn_throughput": 835.577, "update_time_ms": 1.077}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.0005000000237487257, "total_loss": 3.5452113151550293, "policy_loss": -0.05914132669568062, "vf_loss": 7.208705425262451, "vf_explained_var": -0.15086060762405396, "kl": 0.007549839094281197, "entropy": 1.3909121751785278, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}}}, "num_steps_sampled": 728, "num_agent_steps_sampled": 728, "num_steps_trained": 728, "num_agent_steps_trained": 728}, "evaluation": {"episode_reward_max": -3.135035047657235, "episode_reward_min": -3.135035047657235, "episode_reward_mean": -3.135035047657235, "episode_len_mean": 15.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 0.2576179378675365, "cstr_viol_min": 0.2576179378675365, "cstr_viol_max": 0.2576179378675365}, "hist_stats": {"episode_reward": [-3.135035047657235], "episode_lengths": [15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.06978011425630545, "mean_inference_ms": 0.8837764645800178, "mean_action_processing_ms": 0.06175041198730469, "mean_env_wait_ms": 0.35398389086311244, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": false, "episodes_total": 57, "training_iteration": 4, "experiment_id": "56d08bf2f0454f518cb9b9f9cac64b85", "date": "2021-10-13_10-55-20", "timestamp": 1634115320, "time_this_iter_s": 0.30422377586364746, "time_total_s": 1.499314308166504, "pid": 519563, "hostname": "spectral02-sys", "node_ip": "10.60.110.169", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 15, "batch_mode": "complete_episodes", "gamma": 1.0, "lr": 0.0005, "train_batch_size": 150, "model": {"_use_default_native_models": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": true, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Landing1DEnv", "observation_space": null, "action_space": null, "env_config": {"H": 15, "Tmax": 1.227, "c": 2.349, "g": 1.0, "h0": 1.0, "hf": 0.0, "m0": 1.0, "tf": 1.397, "v0": -0.783, "vf": 0.0}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "INFO", "callbacks": "<class 'pyrlprob.utils.callbacks.TrainingCallbacks'>", "ignore_worker_failures": true, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_num_episodes": 1, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"env_config": {"prng_seed": 0}, "explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.0, "sgd_minibatch_size": 15, "shuffle_sequences": true, "num_sgd_iter": 20, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1.499314308166504, "timesteps_since_restore": 0, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 34.9, "ram_util_percent": 22.0}, "trial_id": "477bf_00000"}
{"episode_reward_max": -1.940999490083726, "episode_reward_min": -13.565842787602612, "episode_reward_mean": -8.85013184924349, "episode_len_mean": 12.91304347826087, "episode_media": {}, "episodes_this_iter": 12, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 0.8472750762942245, "cstr_viol_min": 0.1349308190939299, "cstr_viol_max": 1.3384859109932252}, "hist_stats": {"episode_reward": [-11.323882275834798, -8.853504046844465, -12.533355623214977, -13.565842787602612, -11.179632350503603, -13.043990403493245, -11.331709133107468, -10.073984906339719, -12.704161765258256, -12.850951224644978, -13.23098847277959, -9.964552791368817, -9.617687690257323, -8.89745166708712, -11.047989973612358, -11.497816616500886, -2.983645409721909, -8.025866553772515, -6.4023363744531245, -7.967184973025262, -8.98433458556934, -11.91778323702005, -9.595119923432668, -10.576597664041843, -10.688640979897295, -9.541940511110871, -8.950985258906616, -8.40723290514496, -8.950554180213878, -11.146002331083709, -8.379487154760048, -6.713293220248094, -6.610941791306567, -11.075791882495283, -8.928348392327626, -8.591657254611894, -9.023310485944288, -11.692181753651928, -9.06170112698082, -10.230597973118822, -2.9774061294169827, -10.058152567443873, -7.915653680875344, -9.63754549630483, -1.940999490083726, -9.331852721787463, -5.426051890637698, -3.548028893750522, -11.969284816459949, -9.972416605653176, -6.737318001128376, -6.2895839463147265, -8.407947192728763, -9.0303384873233, -5.406509584472341, -10.992621988137563, -9.746676918419546, -10.798082573552026, -9.918281613662295, -6.784492493172131, -7.068980147747313, -4.482475713285968, -6.105329927198445, -4.840245950476074, -5.1338606215800295, -10.935367324409816, -5.411902826502109, -11.666538812451481, -1.9621135315352847], "episode_lengths": [11, 13, 12, 11, 11, 12, 11, 12, 11, 12, 11, 12, 13, 12, 11, 12, 15, 14, 13, 14, 12, 12, 13, 12, 12, 13, 14, 14, 13, 11, 14, 14, 15, 13, 13, 12, 12, 12, 13, 12, 15, 11, 14, 14, 15, 13, 14, 15, 12, 12, 14, 14, 13, 13, 15, 12, 13, 12, 11, 14, 13, 15, 15, 15, 15, 12, 13, 13, 15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.06054051461137822, "mean_inference_ms": 0.660808268983778, "mean_action_processing_ms": 0.05774916041249552, "mean_env_wait_ms": 0.32941523162927533, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}, "num_healthy_workers": 2, "timesteps_total": 891, "agent_timesteps_total": 891, "timers": {"sample_time_ms": 106.411, "sample_throughput": 1674.636, "load_time_ms": 0.017, "load_throughput": 10527112.293, "learn_time_ms": 203.265, "learn_throughput": 876.688, "update_time_ms": 1.096}, "info": {"learner": {"default_policy": {"learner_stats": {"cur_kl_coeff": 0.0, "cur_lr": 0.0005000000237487257, "total_loss": 2.903169631958008, "policy_loss": 0.10707920044660568, "vf_loss": 5.592180252075195, "vf_explained_var": -0.23892353475093842, "kl": 0.009814431890845299, "entropy": 1.3745700120925903, "entropy_coeff": 0.0, "model": {}}, "custom_metrics": {}}}, "num_steps_sampled": 891, "num_agent_steps_sampled": 891, "num_steps_trained": 891, "num_agent_steps_trained": 891}, "evaluation": {"episode_reward_max": -2.3431886405867863, "episode_reward_min": -2.3431886405867863, "episode_reward_mean": -2.3431886405867863, "episode_len_mean": 15.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {"cstr_viol_mean": 0.17405067050141623, "cstr_viol_min": 0.17405067050141623, "cstr_viol_max": 0.17405067050141623}, "hist_stats": {"episode_reward": [-2.3431886405867863], "episode_lengths": [15]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.0675519307454427, "mean_inference_ms": 0.8310923973719279, "mean_action_processing_ms": 0.061792631944020585, "mean_env_wait_ms": 0.3518611192703247, "mean_env_render_ms": 0.0}, "off_policy_estimator": {}}, "done": true, "episodes_total": 69, "training_iteration": 5, "experiment_id": "56d08bf2f0454f518cb9b9f9cac64b85", "date": "2021-10-13_10-55-20", "timestamp": 1634115320, "time_this_iter_s": 0.27896785736083984, "time_total_s": 1.7782821655273438, "pid": 519563, "hostname": "spectral02-sys", "node_ip": "10.60.110.169", "config": {"num_workers": 2, "num_envs_per_worker": 1, "create_env_on_driver": false, "rollout_fragment_length": 15, "batch_mode": "complete_episodes", "gamma": 1.0, "lr": 0.0005, "train_batch_size": 150, "model": {"_use_default_native_models": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": true, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "num_framestacks": "auto", "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "lstm_use_prev_action_reward": -1, "framestack": true}, "optimizer": {}, "horizon": null, "soft_horizon": false, "no_done_at_end": false, "env": "Landing1DEnv", "observation_space": null, "action_space": null, "env_config": {"H": 15, "Tmax": 1.227, "c": 2.349, "g": 1.0, "h0": 1.0, "hf": 0.0, "m0": 1.0, "tf": 1.397, "v0": -0.783, "vf": 0.0}, "env_task_fn": null, "render_env": false, "record_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "preprocessor_pref": "deepmind", "log_level": "INFO", "callbacks": "<class 'pyrlprob.utils.callbacks.TrainingCallbacks'>", "ignore_worker_failures": true, "log_sys_usage": true, "fake_sampler": false, "framework": "tf", "eager_tracing": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "evaluation_interval": 1, "evaluation_num_episodes": 1, "evaluation_parallel_to_training": false, "in_evaluation": false, "evaluation_config": {"env_config": {"prng_seed": 0}, "explore": false}, "evaluation_num_workers": 0, "custom_eval_function": null, "sample_async": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "observation_filter": "NoFilter", "synchronize_filters": true, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "compress_observations": false, "collect_metrics_timeout": 180, "metrics_smoothing_episodes": 100, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "min_iter_time_s": 0, "timesteps_per_iteration": 0, "seed": null, "extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "_fake_gpus": false, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "custom_resources_per_worker": {}, "num_cpus_for_driver": 1, "placement_strategy": "PACK", "input": "sampler", "input_config": {}, "actions_in_input_normalized": false, "input_evaluation": ["is", "wis"], "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "multiagent": {"policies": {"default_policy": ["<class 'ray.rllib.policy.tf_policy_template.PPOTFPolicy'>", null, null, {}]}, "policy_map_capacity": 100, "policy_map_cache": null, "policy_mapping_fn": null, "policies_to_train": null, "observation_fn": null, "replay_mode": "independent", "count_steps_by": "env_steps"}, "logger_config": null, "simple_optimizer": false, "monitor": -1, "use_critic": true, "use_gae": true, "lambda": 1.0, "kl_coeff": 0.0, "sgd_minibatch_size": 15, "shuffle_sequences": true, "num_sgd_iter": 20, "lr_schedule": null, "vf_loss_coeff": 0.5, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.15, "vf_clip_param": 10.0, "grad_clip": null, "kl_target": 0.01, "vf_share_layers": -1}, "time_since_restore": 1.7782821655273438, "timesteps_since_restore": 0, "iterations_since_restore": 5, "perf": {}, "trial_id": "477bf_00000"}
